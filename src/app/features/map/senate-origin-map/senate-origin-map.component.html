<div id="origin-map-host">
  <!-- Language Switcher -->
  <div class="language-switcher">
    <label for="language-select">{{ translate('language.select') || 'Language' }}:</label>
    <select 
      id="language-select" 
      [value]="currentLanguage" 
      (change)="changeLanguage($any($event.target).value)"
      class="language-select">
      <option *ngFor="let lang of availableLanguages" [value]="lang.code">
        {{ lang.name }}
      </option>
    </select>
  </div>

  <div class="map-container">
  <div *ngIf="!mapLayerData" class="loading-state">
    <p>{{ translate('loading.mapData') }}</p>
  </div>

  <div *ngIf="mapLayerData" class="map-content">
    <highcharts-chart
      [Highcharts]="Highcharts"
      [constructorType]="chartConstructor"
      [options]="chartOptions"
      [update]="updateFlag"
      [callbackFunction]="chartCallback"
      style="width: 100%; height: 500px; display: block;"
    ></highcharts-chart>
  </div>

  <div *ngIf="mapLayerData && !isMapReady" class="loading-overlay">
    <p>{{ translate('loading.initializing') }}</p>
  </div>
</div>

<!-- Modal for showing senators per region -->
<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>{{ selectedRegion?.name }} - {{ translate('modal.senateInfo') }}</h3>
      <button class="close-button" (click)="closeModal()">&times;</button>
    </div>
    
    <div class="modal-body">
      <div class="region-info">
        <p><strong>{{ translate('modal.province') }}:</strong> {{ selectedRegion?.province }}</p>
        <p><strong>{{ translate('modal.totalSenators') }}:</strong> {{ selectedRegion?.senators }}</p>
      </div>
      
      <div class="senators-list" *ngIf="regionSenators.length > 0">
        <h4>{{ translate('modal.senatorsFromRegion') }}:</h4>
        <div class="senators-grid">
          <div *ngFor="let senator of regionSenators" class="senator-card">
            <div class="senator-photo">
              <img 
                [src]="senator.photo || 'assets/images/default-senator.svg'" 
                [alt]="senator.fullName"
                (error)="onImageError($event)"
                class="photo-img">
            </div>
            <div class="senator-info">
              <strong class="senator-name">{{ senator.fullName }}</strong>
              <span class="senator-party">{{ senator.party || translate('modal.independent') }}</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="no-senators" *ngIf="regionSenators.length === 0">
        <p>{{ translate('modal.noSenators') }}</p>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="btn btn-primary" (click)="closeModal()">{{ translate('modal.close') }}</button>
    </div>
  </div>
</div>
</div>
