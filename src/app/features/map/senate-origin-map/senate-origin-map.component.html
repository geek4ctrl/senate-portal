<div class="app-container">
  <!-- Top Navigation Bar -->
  <div class="top-nav">
    <div class="nav-left">
      <h1 class="app-title">
        <i class="fas fa-university animate-pulse"></i>
        {{ 'Senat RDC' }}
      </h1>
      <div class="nav-tabs">
        <button class="nav-tab active">
          <i class="fas fa-map-marked-alt tab-icon animate-bounce-gentle"></i>
          {{ translate('nav.map') || 'Map' }}
        </button>
        <button class="nav-tab">
          <i class="fas fa-chart-bar tab-icon"></i>
          {{ translate('nav.analytics') || 'Analytics' }}
        </button>
      </div>
    </div>
    <div class="nav-right">
      <div class="nav-controls">
        <button class="nav-btn" title="Notifications">
          <i class="fas fa-bell animate-swing"></i>
        </button>
        <button class="nav-btn" title="Settings">
          <i class="fas fa-cog animate-spin-slow"></i>
        </button>
        <button class="nav-btn" title="User Profile">
          <i class="fas fa-user-circle animate-glow"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="main-layout">
    <!-- Map Section -->
    <div class="map-section">
      <div id="origin-map-host">
        <div class="map-container">
          <div *ngIf="!mapLayerData" class="loading-state">
            <p>{{ translate('loading.mapData') }}</p>
          </div>

          <div *ngIf="mapLayerData" class="map-content">
            <highcharts-chart
              [Highcharts]="Highcharts"
              [constructorType]="chartConstructor"
              [options]="chartOptions"
              [update]="updateFlag"
              [callbackFunction]="chartCallback"
              style="width: 100%; height: 100%; display: block;"
            ></highcharts-chart>
          </div>

          <div *ngIf="mapLayerData && !isMapReady" class="loading-overlay">
            <p>{{ translate('loading.initializing') }}</p>
          </div>

          <!-- Beautiful Profile Card (like Beth Murphy in the image) -->
          <div class="profile-card" *ngIf="selectedSenator">
            <img
              [src]="selectedSenator.photo || 'assets/images/default-senator.svg'"
              [alt]="selectedSenator.fullName"
              (error)="onImageError($event)"
              class="profile-avatar">

            <div class="profile-name">{{ selectedSenator.fullName }}</div>
            <div class="profile-title">{{ selectedSenator.party || translate('modal.independent') }}</div>

            <div class="profile-stats">
              <div class="stat">
                <span class="stat-value">{{ getRandomStat('distance') }}K</span>
                <span class="stat-label">{{ translate('profile.distance') || 'Distance' }}</span>
              </div>
              <div class="stat">
                <span class="stat-value">{{ getRandomStat('rating') }}</span>
                <span class="stat-label">{{ translate('profile.rating') || 'Rating' }}</span>
              </div>
            </div>

            <div class="profile-timeline">
              <div class="timeline-header">{{ translate('profile.today') || 'TODAY' }}</div>
              <div class="timeline-bars">
                <div class="timeline-bar blue"></div>
                <div class="timeline-bar green"></div>
                <div class="timeline-bar yellow"></div>
                <div class="timeline-bar blue"></div>
                <div class="timeline-bar green"></div>
              </div>
              <div class="timeline-labels">
                <span>9am</span>
                <span>12pm</span>
                <span>3pm</span>
                <span>6pm</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Senators Sidebar -->
    <div class="senators-sidebar">
      <!-- Language Switcher -->
      <div class="language-switcher">
        <i class="fas fa-globe-americas animate-rotate"></i>
        <label for="language-select">{{ translate('language.select') || 'Language' }}:</label>
        <select
          id="language-select"
          [value]="currentLanguage"
          (change)="changeLanguage($any($event.target).value)"
          class="language-select">
          <option *ngFor="let lang of availableLanguages" [value]="lang.code">
            {{ lang.name }}
          </option>
        </select>
      </div>

      <!-- Sidebar Header -->
      <div class="sidebar-header">
        <h3 class="sidebar-title">
          <i class="fas fa-users animate-fade-in"></i>
          {{ translate('sidebar.senators') || 'Senators' }}
        </h3>
        <div class="filter-container">
          <i class="fas fa-search filter-icon animate-pulse-subtle"></i>
          <input
            type="text"
            class="filter-input"
            [placeholder]="translate('sidebar.filterPlaceholder') || 'Filter Senators...'"
            [value]="filterText"
            (input)="onFilterChange($event)">
        </div>
      </div>

      <!-- Senators Count -->
      <div class="senators-count">
        {{ filteredSenators.length }} {{ translate('sidebar.senatorsFound') || 'senators found' }}
      </div>

      <!-- Enhanced Senators List -->
      <div class="senators-list-container">
        <button *ngFor="let senator of filteredSenators; trackBy: getSenatorId"
                class="senator-list-item"
                [class.active]="selectedSenatorId === senator.fullName"
                (click)="selectSenator(senator)"
                [attr.aria-label]="'Select senator ' + senator.fullName">

          <img
            [src]="senator.photo || 'assets/images/default-senator.svg'"
            [alt]="senator.fullName"
            (error)="onImageError($event)"
            class="senator-avatar">

          <div class="senator-details">
            <h4 class="senator-full-name">{{ senator.fullName }}</h4>
            <p class="senator-province">{{ senator.originProvince }}</p>
          </div>

          <div class="senator-status"></div>
        </button>

        <div *ngIf="filteredSenators.length === 0" class="no-results">
          {{ translate('sidebar.noResults') || 'No senators found matching your search.' }}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal for showing senators per region -->
<div class="modal-overlay"
     *ngIf="showModal"
     (click)="closeModal()">
  <div class="modal-content"
       (click)="$event.stopPropagation()"
       role="dialog"
       aria-modal="true">
    <div class="modal-header">
      <h3>{{ selectedRegion?.name }} - {{ translate('modal.senateInfo') }}</h3>
      <button class="close-button"
              (click)="closeModal()"
              aria-label="Close modal">&times;</button>
    </div>

    <div class="modal-body">
      <div class="region-info">
        <p><strong>{{ translate('modal.province') }}:</strong> {{ selectedRegion?.province }}</p>
        <p><strong>{{ translate('modal.totalSenators') }}:</strong> {{ selectedRegion?.senators }}</p>
      </div>

      <div class="senators-list" *ngIf="regionSenators.length > 0">
        <h4>{{ translate('modal.senatorsFromRegion') }}:</h4>
        <div class="senators-grid">
          <div *ngFor="let senator of regionSenators" class="senator-card">
            <div class="senator-photo">
              <img
                [src]="senator.photo || 'assets/images/default-senator.svg'"
                [alt]="senator.fullName"
                (error)="onImageError($event)"
                class="photo-img">
            </div>
            <div class="senator-info">
              <strong class="senator-name">{{ senator.fullName }}</strong>
              <span class="senator-party">{{ senator.party || translate('modal.independent') }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="no-senators" *ngIf="regionSenators.length === 0">
        <p>{{ translate('modal.noSenators') }}</p>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-primary" (click)="closeModal()">{{ translate('modal.close') }}</button>
    </div>
  </div>
</div>
